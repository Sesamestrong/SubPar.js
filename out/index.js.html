<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var colors=require("colors/safe");
/**
 * Represents any parser.
 * @constructor
 * @param equality {function} - Consumes and parses an input - supposed to be the most basic of all operations
 * @param name {string} - The name of the parser, for debugging purposes - optional.
 */
function Parser(equality,name="BasicParser"){
  let ret={equality:equality,name:name};

  /**
   * Determines if a parser's return value is valid - true if valid, false if invalid, and null if nonexistent.
   * @param returnValue {Object} - The parser's return value.
   */
  function validateReturned(retValue){
    return retValue&amp;&amp;retValue.hasOwnProperty("consumed")&amp;&amp;typeof(retValue.consumed)==="number";
  }

  /**
   * Parses an input and updates the info thread accordingly, returning either null or an object of shape {consumed,returned}.
   * @param input {string} - The input for the parser.
   * @param thread {array} - The thread to which to write.
   */
  ret.parse=(input,thread)=>{
    let res=equality(input,thread);
    thread.push(name);
    return res;
  };

  /**
   * Combines itself with a given parser, defaulting to the first parser, but switching to the second if the first fails.
   * @param parser {Object} - The parser with which to combine.
   */
  ret.or=(parser)=>Parser((input,thread)=>ret.parse(input,thread)||parser.parse(input,thread));

  /**
   * Combines itself with a given parser in sequence.
   * @param {Object} - The parser with which to combine.
   */
  ret.then=(parser)=>Parser((input,thread)=>{

    let outputs=[];

    //Parse with each parser until one fails
    for(let i=0;i&lt;2;i++){
      let returned=[ret,parser][i].parse(input,thread);
        console.log(returned,input);
      if(!validateReturned(returned)) return null;
      outputs[i]={valid:validateReturned(returned),returned:returned.returned,consumed:returned.consumed};
      input=input.slice(returned.consumed);
    }

    console.log(JSON.stringify(outputs));
    //If both are valid, return the summed and concatenated consumed number and returned value
    return (outputs.reduce((i,e)=>i.valid&amp;&amp;e.valid))?{consumed:outputs.reduce((i,e)=>i.consumed+e.consumed),returned:outputs.reduce((i,e)=>[i.returned,e.returned])}:null;
  });

  return ret;
}

/**
 * The simplest, string-based parser equality function checking for an exact match between a parameter string and the input's beginning.
 * @param i {string} The string for the input's beginning to match.
 */
function isEqualTo(i,quiet=false){
  return str=>{
    try{
    for(e in i){
      if(str[e]!==i[e]){console.log("oh no!",i,str); throw ValueError;}
    }
    return {consumed:i.length,returned:quiet?null:i};
    } catch(err){return null;}
  };
}

let oneParser=Parser(isEqualTo("Andrew is cool!"),"Coolness");
let nextParser=oneParser.then(Parser(isEqualTo(" Also, ",false),"Space")).then(Parser(isEqualTo("other people!",false),"People"));
let thread=[];
let parsed=(nextParser.parse("Andrew is cool! Also, other people!",thread));
let counter=0;
console.log("\n\n");
console.log(parsed.returned.map(i=>colors[["red","green"][counter++%2]](i)).join(""));
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Parser.html">Parser</a></li></ul><h3>Global</h3><ul><li><a href="global.html#isEqualTo">isEqualTo</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sun Feb 24 2019 15:16:37 GMT-0500 (Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
